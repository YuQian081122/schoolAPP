# Action ä¼ºæœå™¨ç¨ç«‹éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æ ¹æ“šæ—¥èªŒåˆ†æï¼Œ**å»ºè­°éƒ¨ç½²ç¨ç«‹çš„ Action ä¼ºæœå™¨**ã€‚åŸå› ï¼š

1. **æ—¥èªŒé¡¯ç¤ºéŒ¯èª¤**: Rasa å˜—è©¦é€£æ¥åˆ° action serverï¼Œä½†æ‰¾ä¸åˆ°
2. **Rasa 3.5 æœ€ä½³å¯¦è¸**: ä½¿ç”¨ `rasa-sdk` æ™‚ï¼Œå»ºè­°ä½¿ç”¨ç¨ç«‹çš„ action server
3. **ç”Ÿç”¢ç’°å¢ƒç©©å®šæ€§**: ç¨ç«‹éƒ¨ç½²å¯ä»¥æä¾›æ›´å¥½çš„éš”é›¢å’Œæ“´å±•æ€§

## ğŸ¯ éƒ¨ç½²æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel Frontendâ”‚ â”€â”€â”€â”€â”€â”€> â”‚  Rasa Service    â”‚
â”‚                 â”‚         â”‚  (Port 5005)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ HTTP
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Action Server     â”‚
                            â”‚ (Port 5055)       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ éƒ¨ç½²æ­¥é©Ÿ

### æ­¥é©Ÿ 1: åœ¨ Zeabur å‰µå»º Action Server æœå‹™

1. **å‰µå»ºæ–°æœå‹™**:
   - æœå‹™åç¨±: `rasa-action-server`
   - ä½¿ç”¨ Dockerfile: `rasa/Dockerfile.action-server`

2. **è¨­ç½®ç’°å¢ƒè®Šæ•¸**:
   - `PORT`: `5055`ï¼ˆZeabur æœƒè‡ªå‹•è¨­ç½®ï¼Œä½†å¯ä»¥æ˜ç¢ºæŒ‡å®šï¼‰

3. **ç²å– Action Server URL**:
   - éƒ¨ç½²å®Œæˆå¾Œï¼ŒZeabur æœƒæä¾› URLï¼Œä¾‹å¦‚: `https://rasa-action-server-xxx.zeabur.app`

### æ­¥é©Ÿ 2: æ›´æ–° Rasa ä¸»æœå‹™é…ç½®

1. **æ›´æ–° `rasa/endpoints.yml`**:
   ```yaml
   action_endpoint:
     url: "https://rasa-action-server-xxx.zeabur.app/webhook"
   ```

2. **æˆ–è€…ä½¿ç”¨ç’°å¢ƒè®Šæ•¸**ï¼ˆæ¨è–¦ï¼‰:
   ```yaml
   action_endpoint:
     url: "${ACTION_SERVER_URL}/webhook"
   ```
   
   ç„¶å¾Œåœ¨ Zeabur Rasa æœå‹™ä¸­è¨­ç½®ç’°å¢ƒè®Šæ•¸:
   - `ACTION_SERVER_URL`: `https://rasa-action-server-xxx.zeabur.app`

### æ­¥é©Ÿ 3: é‡æ–°éƒ¨ç½² Rasa æœå‹™

æ›´æ–°é…ç½®å¾Œï¼Œé‡æ–°éƒ¨ç½² Rasa æœå‹™ä»¥æ‡‰ç”¨æ›´æ”¹ã€‚

## ğŸ”§ é…ç½®æ–‡ä»¶

### 1. Action Server Dockerfile (`rasa/Dockerfile.action-server`)

å·²å‰µå»ºï¼ŒåŒ…å«ï¼š
- Python 3.10 åŸºç¤é¡åƒ
- åªå®‰è£ `rasa-sdk`ï¼ˆä¸éœ€è¦å®Œæ•´çš„ Rasaï¼‰
- è¤‡è£½ actions ç›®éŒ„
- å•Ÿå‹•è…³æœ¬

### 2. Action Server å•Ÿå‹•è…³æœ¬ (`rasa/start_action_server.sh`)

å·²å‰µå»ºï¼ŒåŒ…å«ï¼š
- è¨­ç½® PYTHONPATH
- æª¢æŸ¥ actions æ¨¡å¡Š
- å•Ÿå‹• `rasa run actions`

### 3. æ›´æ–° `rasa/endpoints.yml`

éœ€è¦å–æ¶ˆè¨»é‡‹ `action_endpoint` ä¸¦è¨­ç½®æ­£ç¢ºçš„ URLã€‚

## âœ… é©—è­‰éƒ¨ç½²

### æª¢æŸ¥ Action Server

1. **å¥åº·æª¢æŸ¥**:
   ```bash
   curl https://rasa-action-server-xxx.zeabur.app/health
   ```

2. **æª¢æŸ¥å¯ç”¨ Actions**:
   ```bash
   curl https://rasa-action-server-xxx.zeabur.app/actions
   ```

### æª¢æŸ¥ Rasa æœå‹™

1. **æª¢æŸ¥ Status**:
   ```bash
   curl https://rasa-service.zeabur.app/status
   ```

2. **æ¸¬è©¦ Action åŸ·è¡Œ**:
   - ç™¼é€æ¶ˆæ¯è§¸ç™¼éœ€è¦ action çš„æ„åœ–
   - æª¢æŸ¥æ—¥èªŒç¢ºèª action æ˜¯å¦æˆåŠŸåŸ·è¡Œ

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œ 1: Action Server ç„¡æ³•å•Ÿå‹•

**æª¢æŸ¥**:
- Action Server æ—¥èªŒ
- `actions` ç›®éŒ„æ˜¯å¦æ­£ç¢ºè¤‡è£½
- Python ä¾è³´æ˜¯å¦æ­£ç¢ºå®‰è£

**è§£æ±º**:
- ç¢ºä¿ `rasa-sdk==3.5.1` å·²å®‰è£
- æª¢æŸ¥ `actions/__init__.py` æ˜¯å¦æ­£ç¢ºå°å‡ºæ‰€æœ‰ actions

### å•é¡Œ 2: Rasa ç„¡æ³•é€£æ¥åˆ° Action Server

**æª¢æŸ¥**:
- `endpoints.yml` ä¸­çš„ URL æ˜¯å¦æ­£ç¢º
- Action Server æ˜¯å¦æ­£åœ¨é‹è¡Œ
- ç¶²çµ¡é€£æ¥æ˜¯å¦æ­£å¸¸

**è§£æ±º**:
- ç¢ºèª Action Server URL æ­£ç¢º
- æª¢æŸ¥ CORS è¨­ç½®ï¼ˆAction Server æ‡‰è©²å…è¨±ä¾†è‡ª Rasa çš„è«‹æ±‚ï¼‰
- ç¢ºèªå…©å€‹æœå‹™éƒ½åœ¨é‹è¡Œ

### å•é¡Œ 3: Actions åŸ·è¡Œå¤±æ•—

**æª¢æŸ¥**:
- Action Server æ—¥èªŒ
- Rasa æ—¥èªŒä¸­çš„éŒ¯èª¤ä¿¡æ¯
- Actions ä»£ç¢¼æ˜¯å¦æœ‰èªæ³•éŒ¯èª¤

**è§£æ±º**:
- æª¢æŸ¥ actions ä»£ç¢¼
- ç¢ºèªæ‰€æœ‰ä¾è³´éƒ½å·²å®‰è£
- æª¢æŸ¥ actions çš„è¿”å›å€¼æ ¼å¼

## ğŸ“Š å„ªå‹¢

### âœ… ç¨ç«‹éƒ¨ç½²çš„å„ªå‹¢

1. **éš”é›¢æ€§**: Action éŒ¯èª¤ä¸æœƒå½±éŸ¿ Rasa ä¸»æœå‹™
2. **å¯æ“´å±•æ€§**: å¯ä»¥ç¨ç«‹æ“´å±• Action Server
3. **ç©©å®šæ€§**: ç¬¦åˆ Rasa 3.x æœ€ä½³å¯¦è¸
4. **èª¿è©¦**: æ›´å®¹æ˜“èª¿è©¦å’Œç›£æ§

### âš ï¸ æ³¨æ„äº‹é …

1. **è³‡æºæ¶ˆè€—**: éœ€è¦é‹è¡Œå…©å€‹æœå‹™
2. **ç¶²çµ¡å»¶é²**: æœå‹™é–“é€šä¿¡æœƒæœ‰è¼•å¾®å»¶é²
3. **é…ç½®è¤‡é›œåº¦**: éœ€è¦é…ç½®å…©å€‹æœå‹™

## ğŸš€ å¿«é€Ÿé–‹å§‹

1. **éƒ¨ç½² Action Server**:
   ```bash
   # åœ¨ Zeabur å‰µå»ºæ–°æœå‹™ï¼Œä½¿ç”¨ Dockerfile.action-server
   ```

2. **æ›´æ–° endpoints.yml**:
   ```yaml
   action_endpoint:
     url: "${ACTION_SERVER_URL}/webhook"
   ```

3. **è¨­ç½®ç’°å¢ƒè®Šæ•¸**:
   - åœ¨ Rasa æœå‹™ä¸­è¨­ç½® `ACTION_SERVER_URL`

4. **é‡æ–°éƒ¨ç½² Rasa æœå‹™**

5. **æ¸¬è©¦**: ç™¼é€æ¶ˆæ¯æ¸¬è©¦ actions æ˜¯å¦æ­£å¸¸å·¥ä½œ

---

**ç‹€æ…‹**: âœ… é…ç½®æ–‡ä»¶å·²å‰µå»º
**ä¸‹ä¸€æ­¥**: åœ¨ Zeabur éƒ¨ç½² Action Server ä¸¦æ›´æ–°é…ç½®
