# ç¶²é èˆ‡ AI ä¼ºæœå™¨é€£æ¥ç‹€æ…‹æª¢æŸ¥å ±å‘Š

## æª¢æŸ¥æ™‚é–“
2025-01-22

## æª¢æŸ¥çµæœç¸½çµ

### âœ… é€£æ¥ç‹€æ…‹ï¼šæ­£å¸¸

æ ¹æ“šç¶²çµ¡è«‹æ±‚æ—¥èªŒå’Œä»£ç¢¼æª¢æŸ¥ï¼Œå‰ç«¯ç¶²é å·²æˆåŠŸé€£æ¥åˆ° Rasa AI ä¼ºæœå™¨ã€‚

## è©³ç´°æª¢æŸ¥çµæœ

### 1. å‰ç«¯é€£æ¥é‚è¼¯ âœ…

**æª¢æŸ¥é …ç›®ï¼š**
- `getRasaServerURL()` å‡½æ•¸é‚è¼¯
- Vercel ç’°å¢ƒæª¢æ¸¬
- ç›¸å°è·¯å¾‘é…ç½®

**çµæœï¼š**
- âœ… `getRasaServerURL()` æ­£ç¢ºæª¢æ¸¬åˆ° Vercel ç’°å¢ƒ
- âœ… è‡ªå‹•ä½¿ç”¨ç›¸å°è·¯å¾‘ `/rasa`ï¼ˆé€šé `vercel.json` çš„ rewrite è¦å‰‡è½‰ç™¼åˆ° `/api/rasa/*`ï¼‰
- âœ… æ­£ç¢ºæ¸…é™¤èˆŠçš„ Railway/Zeabur URLï¼ˆå¦‚æœå­˜åœ¨æ–¼ localStorageï¼‰

**ä»£ç¢¼ä½ç½®ï¼š**
- `ai-chat.js` ç¬¬ 1393-1523 è¡Œï¼š`getRasaServerURL()` å‡½æ•¸
- `ai-chat.js` ç¬¬ 11361-11575 è¡Œï¼š`checkRasaConnection()` å‡½æ•¸

### 2. API ç«¯é»æ¸¬è©¦ âœ…

**æª¢æŸ¥é …ç›®ï¼š**
- `/rasa/status` ç«¯é»ï¼ˆé€šé Vercel API routeï¼‰
- `/rasa/webhooks/rest/webhook` ç«¯é»ï¼ˆé€šé Vercel API routeï¼‰

**ç¶²çµ¡è«‹æ±‚æ—¥èªŒï¼š**
```
GET  /rasa/status                   200 OK
POST /rasa/webhooks/rest/webhook    200 OK
```

**çµæœï¼š**
- âœ… `/rasa/status` ç«¯é»æ­£å¸¸éŸ¿æ‡‰ï¼ˆç‹€æ…‹ç¢¼ 200ï¼‰
- âœ… `/rasa/webhooks/rest/webhook` ç«¯é»æ­£å¸¸éŸ¿æ‡‰ï¼ˆç‹€æ…‹ç¢¼ 200ï¼‰
- âœ… Vercel API routes æ­£ç¢ºè½‰ç™¼è«‹æ±‚åˆ° Zeabur Rasa æœå‹™å™¨

**ç›¸é—œæ–‡ä»¶ï¼š**
- `api/rasa/status.js` - Vercel API route ç”¨æ–¼ç‹€æ…‹æª¢æŸ¥
- `api/rasa/webhook.js` - Vercel API route ç”¨æ–¼æ¶ˆæ¯è½‰ç™¼
- `vercel.json` - Rewrite è¦å‰‡é…ç½®

### 3. ç€è¦½å™¨æ§åˆ¶å°æª¢æŸ¥ âœ…

**æª¢æŸ¥é …ç›®ï¼š**
- æ§åˆ¶å°æ—¥èªŒè¨Šæ¯
- éŒ¯èª¤å’Œè­¦å‘Š

**æ§åˆ¶å°è¨Šæ¯ï¼š**
```
ğŸŒ æª¢æ¸¬åˆ° Vercel éƒ¨ç½²ç’°å¢ƒï¼Œè·³é Railway é…ç½®ï¼Œå°‡ä½¿ç”¨ç›¸å°è·¯å¾‘
ğŸ” [Head] è¨­å‚™æª¢æ¸¬: [object Object]
ğŸ’» [Head] æª¢æ¸¬åˆ°æ¡Œé¢è¨­å‚™ï¼Œä¿æŒç•¶å‰ç‰ˆæœ¬
```

**çµæœï¼š**
- âœ… æ­£ç¢ºæª¢æ¸¬åˆ° Vercel ç’°å¢ƒ
- âœ… æ²’æœ‰é€£æ¥éŒ¯èª¤
- âš ï¸ ä»æœ‰ `railway-config.js` çš„è­¦å‘Šï¼ˆä½†å·²æ­£ç¢ºè·³é Railway é…ç½®ï¼‰

### 4. Rasa ä¼ºæœå™¨ç‹€æ…‹ âœ…

**æª¢æŸ¥é …ç›®ï¼š**
- Zeabur Rasa æœå‹™å™¨ç›´æ¥é€£æ¥
- æœå‹™å™¨å¥åº·ç‹€æ…‹

**é æœŸé…ç½®ï¼š**
- Zeabur æœå‹™å™¨ URL: `https://rasa-service.zeabur.app`
- Vercel ç’°å¢ƒè®Šæ•¸: `RASA_SERVER_URL` æ‡‰è¨­ç½®ç‚ºä¸Šè¿° URL

**çµæœï¼š**
- âœ… API routes æˆåŠŸè½‰ç™¼è«‹æ±‚åˆ° Zeabur
- âœ… æœå‹™å™¨éŸ¿æ‡‰æ­£å¸¸ï¼ˆé€šé Vercel API routes é©—è­‰ï¼‰

## é€£æ¥æµç¨‹åœ–

```
å‰ç«¯ç¶²é  (Vercel)
    â†“
ç™¼é€è«‹æ±‚åˆ° /rasa/status æˆ– /rasa/webhooks/rest/webhook
    â†“
Vercel Rewrite è¦å‰‡ (vercel.json)
    â†“
è½‰ç™¼åˆ° /api/rasa/status æˆ– /api/rasa/webhook
    â†“
Vercel API Route (api/rasa/status.js æˆ– api/rasa/webhook.js)
    â†“
è®€å–ç’°å¢ƒè®Šæ•¸ RASA_SERVER_URL
    â†“
è½‰ç™¼è«‹æ±‚åˆ° Zeabur Rasa æœå‹™å™¨
    â†“
https://rasa-service.zeabur.app/status æˆ– /webhooks/rest/webhook
    â†“
è¿”å›éŸ¿æ‡‰åˆ°å‰ç«¯
```

## é…ç½®é©—è­‰

### Vercel é…ç½® âœ…
- âœ… `vercel.json` é…ç½®æ­£ç¢º
- âœ… Rewrite è¦å‰‡æ­£ç¢ºè¨­ç½®
- âš ï¸ éœ€è¦ç¢ºèªç’°å¢ƒè®Šæ•¸ `RASA_SERVER_URL` æ˜¯å¦åœ¨ Vercel Dashboard ä¸­è¨­ç½®

### å‰ç«¯é…ç½® âœ…
- âœ… `getRasaServerURL()` æ­£ç¢ºè¿”å› `/rasa`
- âœ… `checkRasaConnection()` æ­£å¸¸åŸ·è¡Œ
- âœ… å¥åº·æª¢æŸ¥æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ

## ç™¼ç¾çš„å•é¡Œ

### 1. railway-config.js ä»è¢«è¼‰å…¥ âš ï¸
- **å•é¡Œï¼š** `railway-config.js` ä»åœ¨ HTML ä¸­è¢«å¼•ç”¨
- **å½±éŸ¿ï¼š** è¼•å¾®ï¼ˆå·²æ­£ç¢ºè·³éé…ç½®ï¼‰
- **å»ºè­°ï¼š** å¯ä»¥å¾ `ai-chat.html` ä¸­ç§»é™¤è©²è…³æœ¬å¼•ç”¨

### 2. éœ€è¦ç¢ºèªç’°å¢ƒè®Šæ•¸ âš ï¸
- **å•é¡Œï¼š** ç„¡æ³•ç›´æ¥é©—è­‰ Vercel Dashboard ä¸­çš„ç’°å¢ƒè®Šæ•¸è¨­ç½®
- **å»ºè­°ï¼š** è«‹åœ¨ Vercel Dashboard ä¸­ç¢ºèª `RASA_SERVER_URL` æ˜¯å¦è¨­ç½®ç‚º `https://rasa-service.zeabur.app`

## æ¸¬è©¦å»ºè­°

### æ‰‹å‹•æ¸¬è©¦æ­¥é©Ÿ

1. **æ‰“é–‹ AI èŠå¤©é é¢**
   ```
   https://school-app-two-pi.vercel.app/ai-chat.html
   ```

2. **æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ï¼ˆF12ï¼‰**

3. **åœ¨æ§åˆ¶å°åŸ·è¡Œè¨ºæ–·**
   ```javascript
   await checkRasaConnection(true)
   diagnoseRasaConnection()
   ```

4. **ç™¼é€æ¸¬è©¦æ¶ˆæ¯**
   - åœ¨èŠå¤©æ¡†ä¸­è¼¸å…¥ã€Œæ—©å®‰ã€
   - æª¢æŸ¥æ˜¯å¦æ”¶åˆ° AI å›æ‡‰

5. **æª¢æŸ¥ç¶²çµ¡è«‹æ±‚**
   - åœ¨ Network æ¨™ç±¤ä¸­æŸ¥çœ‹ `/rasa/status` å’Œ `/rasa/webhooks/rest/webhook` è«‹æ±‚
   - ç¢ºèªç‹€æ…‹ç¢¼ç‚º 200
   - æª¢æŸ¥éŸ¿æ‡‰å…§å®¹

## çµè«–

âœ… **é€£æ¥ç‹€æ…‹æ­£å¸¸**

å‰ç«¯ç¶²é å·²æˆåŠŸé€£æ¥åˆ° Rasa AI ä¼ºæœå™¨ã€‚æ‰€æœ‰ API ç«¯é»éƒ½æ­£å¸¸éŸ¿æ‡‰ï¼Œé€£æ¥æµç¨‹é‹ä½œæ­£å¸¸ã€‚

**ä¸‹ä¸€æ­¥ï¼š**
1. ç¢ºèª Vercel Dashboard ä¸­çš„ç’°å¢ƒè®Šæ•¸è¨­ç½®
2. æ¸¬è©¦å¯¦éš›å°è©±åŠŸèƒ½ï¼ˆç™¼é€ã€Œæ—©å®‰ã€ç­‰æ¶ˆæ¯ï¼‰
3. å¦‚æœ AI æ²’æœ‰å›æ‡‰ï¼Œæª¢æŸ¥ Rasa æœå‹™å™¨çš„å‹•ä½œåŸ·è¡Œå•é¡Œï¼ˆåƒè€ƒä¹‹å‰çš„é™¤éŒ¯å ±å‘Šï¼‰
